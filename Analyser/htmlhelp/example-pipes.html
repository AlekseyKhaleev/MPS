<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=windows-1251">
  <title></title>
  <meta name="description" content="">
  <meta name="keywords" content="">
  <meta name="author" content="VAN">
  <meta name="generator" content="Quanta Plus">
</head>
<body>

<a name="pipes">
<h1>5.4. Проверка программных каналов (cputest-pipe-sender.sch и cputest-pipe-receiver.sch)</h1>

<p style="text-align: justify">Компоненты типа «Канал передачи данных» позволяют нескольким 
экземплярам программы обмениваться данными между собой. Присутствуют 
как простые, так и сложные (с управляющими сигналами) варианты. 
</p>

<p style="text-align: justify">Следующие две схемы позволяют проверить правильность работы таких элементов</p>

<p>Передатчик:</p>

<img src="images/samples/image026.png" width="964" height="560" alt="" border="0">

<p>Приемник:</p>

<img src="images/samples/image028.png" width="962" height="638" alt="" border="0">

<p style="text-align: justify">В данном случае оба экземпляра программы были запущены на одной машине. 
Есть возможность использования в сети, для чего нужно указывать полные 
UNC-имена программных каналов (см. описания соответствующих компонентов).</p>

<p style="text-align: justify">Сигналы готовности RDYR и RDYW используются в качестве сигналов 
запроса прерывания. Шинные формирователи в схемах служат для 
ввода кода команды RST.7 (или другого, код задается линейкой 
переключателей слева от ШФ) в ответ на сигнал INTA. Регистр в приемнике 
играет роль порта вывода и служит для вывода полученного байта на индикаторы.</p>

<p style="text-align: justify">При работе приемник передает байты данных (с увеличивающимся значением), 
приемник их принимает и высвечивает на индикаторах.</p>

<p>Процессор в схеме передатчика выполняет программу:</p>
					   
<table border="2" bgcolor="white">
<tr><td><b>Адрес</b></td>
<td><b>Мнемоника</b></td>
<td><b>Комментарий</b></td>
</tr> 

<tr><td><b>Точка входа</b></td></tr>

<tr><td>0000h</td>
<td>XRA A</td>
<td>Очистка аккумулятора. Начальный передаваемый байт равен нулю</td>
</tr> 

<tr><td>0001h</td>
<td>LXI SP, 1000h</td>
<td>Загрузка указателя стека</td>
</tr> 

<tr><td>0004h</td>
<td>EI</td>
<td>Разрешаем обработку прерываний</td>
</tr> 

<tr><td>0005h</td>
<td>JMP 0005h</td>
<td>Вечный цикл. Здесь могут происходить прерывания</td>
</tr> 

<tr><td><b>Процедура обработки прерываний (ISR)</b></td></tr>
 
<tr><td>0038h</td>
<td>INR A</td>
<td>Увеличиваем значение аккумулятора</td>
</tr> 

<tr><td>0039h</td>
<td>OUT 00h</td>
<td>Передаем байт по каналу</td>
</tr> 

<tr><td>003Bh</td>
<td>EI</td>
<td>Разрешаем обработку прерываний</td>
</tr> 

<tr><td>003Ch</td>
<td>RET</td>
<td>Выходим из ISR</td>
</tr> 
</table>

<p>Приемник:</p>

<table border="2" bgcolor="white">
<tr><td><b>Адрес</b></td>
<td><b>Мнемоника</b></td>
<td><b>Комментарий</b></td>
</tr> 

<tr><td><b>Точка входа</b></td></tr>
 
<tr><td>0000h</td>
<td>XRA A</td>
<td>Очистка аккумулятора. Начальный передаваемый байт равен нулю</td>
</tr> 

<tr><td>0001h</td>
<td>LXI SP, 1000h</td>
<td>Загрузка указателя стека</td>
</tr> 

<tr><td>0004h</td>
<td>EI</td>
<td>Разрешаем обработку прерываний</td>
</tr> 

<tr><td>0005h</td>
<td>JMP 0005h</td>
<td>Вечный цикл. Здесь могут происходить прерывания</td>
</tr> 

<tr><td><b>Процедура обработки прерываний (ISR)</b></td></tr>
 
<tr><td>0038h</td>
<td>IN 00h</td>
<td>Принимаем байт</td>
</tr> 

<tr><td>003Ah</td>
<td>OUT 00h</td>
<td>Выводим его на индикаторы</td>
</tr> 

<tr><td>003Ch</td>
<td>EI</td>
<td>Разрешаем обработку прерываний</td>
</tr> 

<tr><td>003Dh</td>
<td>RET</td>
<td>Выходим из ISR</td>
</tr> 
</table>


</body>
</html>